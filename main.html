<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=7, IE=9, IE=10"> 
    <!--The viewport meta tag is used to improve the presentation and behavior of the samples 
      on iOS devices-->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"> 
    <title>REAtlas - Aarhus</title>

    <link rel="stylesheet" href="http://js.arcgis.com/3.6/js/dojo/dijit/themes/claro/claro.css">
    <link rel="stylesheet" href="http://js.arcgis.com/3.6/js/esri/css/esri.css" />
    <link rel="stylesheet" href="css/layout.css"/> 

    <script>var dojoConfig = { parseOnLoad: true };</script>
    <script src="http://js.arcgis.com/3.6/"></script>
    <script src="js/jquery-1.10.2.js"></script>
    <script>
        
      function fetchCutoutList(userName,divID) {   
            require(["dojo/_base/xhr"], function(xhr){
            // get some data, convert to JSON
            xhr.post({
                url:"/reatlas/cutoutlist_ajax.php",
                handleAs:"json",
                timeout: 3000, // give up after 3 seconds
                content: { user:userName}, // creates ?part=one&another=part with GET, Sent as POST data when using xhrPost
                load: function(data){
                    if($("#"+divID).html() == "Loading...")
                        $("#"+divID).html('');
                      for(var i in data){
                       //console.log("key", i, "value", data[i]);
                       //console.log(data[i].cutout," ",data[i].cutoutId);
                       if(data[i].cutout !=userName)
                       $("#"+divID).append("<label><input type=\"radio\" class=\"radio\" name=\"cutoutSelGrpDefault\" value=\""+data[i].cutoutId+"\">"+data[i].cutout+"</label><br/>");
                    }
                    
                    if($(data).size()==0 && $("#"+divID).html() == '')
                        $("#"+divID).html('No cutout found');
                    
                  
                }
            });
        });
      }
      dojo.require("dijit.layout.BorderContainer");
      dojo.require("dijit.layout.ContentPane");
      dojo.require("esri.map");
      dojo.require("dijit.layout.TabContainer");
      dojo.require("esri.dijit.Legend");
      
      var map;

      function init() {
        map = new esri.Map("map", {
          center: [-85.772, 38.255],
          zoom: 10,
          basemap : "topo"
        });
        var basemapUrl = "http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer";
        var dynamicUrl = "http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyHazardsandRisks/MapServer";
        var referenceUrl = "http://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer";
        
        var basemap = new esri.layers.ArcGISTiledMapServiceLayer(basemapUrl);
        var dynamicLayer = new esri.layers.ArcGISDynamicMapServiceLayer(dynamicUrl,{opacity:0.45});
        var referenceLayer = new esri.layers.ArcGISTiledMapServiceLayer(referenceUrl);
        
        dojo.connect(map, "onLayersAddResult", function(results) {
         
        });
       // map.addLayer(basemap);
       // map.addLayers([dynamicLayer,referenceLayer]);
      }
        dojo.ready(init);
        dojo.ready(function(){
            dojo.query(".info").attr("innerHTML", dojo.version);
            
        });
fetchCutoutList('auesg','cutoutSelGrpDefault');
    </script>
    <script type="text/javascript">
        $(document).ready(function() {
            // Handler for .ready() called.
            $('input[name="cutoutSelectorGroup"]:radio').change(
                function(){
                    console.log('changed: '+$(this).val());  
                    
                    if($(this).val() =="default"){
                      $('#cutoutSelGrpDefault').css('display','block'); 
                      $('#cutoutSelGrpOwn').css('display','none');
                      $('#cutoutSelGrpAll').css('display','none');
                      $('#cutoutSelGrpDefault').html('Loading...');
                      fetchCutoutList('auesg','cutoutSelGrpDefault');
                    }else if($(this).val() =="own"){
                      $('#cutoutSelGrpDefault').css('display','none'); 
                      $('#cutoutSelGrpOwn').css('display','block');
                      $('#cutoutSelGrpAll').css('display','none');
                       $('#cutoutSelGrpOwn').html('Loading...');
                      fetchCutoutList('manila','cutoutSelGrpOwn');
                    }else if($(this).val() =="all"){
                      $('#cutoutSelGrpDefault').css('display','none'); 
                      $('#cutoutSelGrpOwn').css('display','none');
                      $('#cutoutSelGrpAll').css('display','block');
                       $('#cutoutSelGrpAll').html('Loading...');
                      fetchCutoutList('auesg','cutoutSelGrpAll');
                      fetchCutoutList('manila','cutoutSelGrpAll');
                    }
                }
            ); 
        });
    </script>
  </head>
  
  <body class="claro">
    <div id="mainWindow" 
         data-dojo-type="dijit.layout.BorderContainer" 
         data-dojo-props="design:'headline', gutters:false" 
         style="width:100%; height:100%;">

      <div id="header" 
           data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'top'">
          <div id="headerLeft">
        REAtlas
       <div id="subheader">Aarhus University,Aarhus Denmark</div>
       </div>
       <div id="headerRight">Welcome, Manila<br/><a href="index.html">Logout</a></div>
      </div>
      <div id="map" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'center'"></div>
      <div data-dojo-type="dijit.layout.ContentPane" id="rightPane" data-dojo-props="region:'right'">
        <div data-dojo-type="dijit.layout.TabContainer" ><!-- tabPosition="left-h" tabStrip="false"-->

          <div data-dojo-type="dijit.layout.ContentPane" data-dojo-props="title:'Cutouts', selected:true">
            <div id="selectorDiv">
                <div id="selectorTopDiv">
                    <label class="blue"><input type="radio" name="cutoutSelectorGroup" value="default" checked="checked"><span>Default</span></label>
                    <label class="green"><input type="radio" name="cutoutSelectorGroup" value="own"><span>Own</span></label>
                    <label class="yellow"><input type="radio" name="cutoutSelectorGroup" value="all"><span>All</span></label>
                </div>
                <div id="selectorContentDiv" >
                    <div id="cutoutSelGrpDefault" >
                        <!--label><input type="radio" class="radio" name="cutoutSelGrpDefault" value="europe">Europe</label><br/>
                        <label><input type="radio" class="radio" name="cutoutSelGrpDefault" value="usa">USA</label><br/>
                        <label><input type="radio" class="radio" name="cutoutSelGrpDefault" value="india">India</label><br/>
                        <label><input type="radio" class="radio" name="cutoutSelGrpDefault" value="n-africa">North Africa</label><br/>
                        <label><input type="radio" class="radio" name="cutoutSelGrpDefault" value="createNew">Create new</label><br/-->
                    </div>
                    <div id="cutoutSelGrpOwn" style="display: none;">Own group</div>
                    <div id="cutoutSelGrpAll" style="display: none;">All group</div>
                </div>
            </div>
            <div id="cutoutInfoDiv">iuyoiyioyoyoi</div>
          </div>

          <div data-dojo-type="dijit.layout.ContentPane" data-dojo-props="title:'Maps',showTitle:true" >
            Content for the second tab
          </div>

        </div>
      </div>
      <div id="footer" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'bottom'">
        Â© 2013-2014 Aarhus University - au.dk
      </div>
      
    </div>
      <div class="info">VERSION:</div>
  </body>

</html>
